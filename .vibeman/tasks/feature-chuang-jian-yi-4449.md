---
id: feature-chuang-jian-yi-4449
title: 创建一个 Chinese copy formatting 的网站
type: feature
status: backlog
priority: high
tags: []
created_at: '2026-02-24T21:49:39.290Z'
updated_at: '2026-02-24T22:00:30.933Z'
---

## Goal

基于《中文文案排版指北》提供一个可直接使用的网页工具，让用户输入中文文案后能立即看到规范化结果与问题位置，从而降低人工排版校对成本。最终用户可以清楚知道哪里错、为何错、如何改。

## Context

当前仓库仅包含任务管理文件（`.vibeman/tasks/feature-chuang-jian-yi-4449.md`）与 `.vibeman/vibeman.db`，尚未存在前端项目代码、规则引擎代码、测试目录或部署配置。
需求来源文档为 `https://github.com/sparanoid/chinese-copywriting-guidelines`，目标能力包括文案纠错、自动修正、输入输出双栏展示、错误位置高亮。

## Requirements

- [ ] 页面提供双栏布局：左侧为可编辑输入区，右侧为格式化输出区；两侧同时显示同一段文案的原始与修正结果。
- [ ] 系统依据《中文文案排版指北》规则对输入文本执行检查与修正，至少覆盖中英文/数字间空格、常见中英文标点规范、全角半角混用三类规则。
- [ ] 输出区对每一处修正提供可视化高亮，且可区分“已修正文本片段”与“未变更文本片段”。
- [ ] 每一处高亮可追溯到对应规则信息（规则名或说明），用户可以理解该处被修改的原因。
- [ ] 当输入文本已符合规则时，系统明确展示“无排版问题”状态，且输出与输入完全一致。
- [ ] 当输入为空、仅空白字符或仅换行时，系统不报错；输出为空并保持页面可交互。
- [ ] 系统正确处理多行文本，不丢失原有换行结构；URL、邮箱、代码片段样式文本不被误改。
- [ ] 提供纠错结果统计信息，至少包含总问题数与按规则分类计数。
- [ ] 核心规则引擎具备自动化测试，覆盖正常场景与边界场景；关键前端交互具备端到端或集成测试验证。
- [ ] 项目在本地可通过统一命令完成静态检查、测试与构建，且全部通过。

## Implementation Notes

- 目标目录（建议）：`src/`（页面与组件）、`src/rules/`（规则定义）、`src/engine/`（检测与修正规则执行）、`tests/`（单测与集成/E2E）。
- 规则组织模式：规则元信息（id、描述、示例）与执行逻辑分离；每条规则输出统一诊断结构（位置、原文、建议、修正后文本）。
- 高亮数据模型：基于字符区间或 token 区间映射，支持多处不连续高亮与多行文本定位。
- 验证命令（按最终技术栈落地）：`npm run lint`、`npm run test`、`npm run build`、`npm run test:e2e`。
- 边界场景：中英文混排、数字与单位组合、连续标点、全角半角混排、Markdown 链接、超长文本（例如 5k+ 字符）。
- 主要风险：规则相互覆盖导致重复修改、中文标点上下文判断误判、高亮索引与修正后文本错位、长文本性能退化。
- 非目标范围：用户系统、云端存储、协作编辑、富文本编辑器、服务端语法分析。

## Recommended Steps

- Step 1: 范围冻结与样例集建立
  - [ ] 明确首版规则清单与优先级，形成可追踪规则表（规则 id、说明、输入示例、期望输出）。
  - [ ] 从《中文文案排版指北》整理最小可用测试语料，覆盖正例、反例与边界案例。
  - [ ] 定义统一诊断数据结构与输出契约，确保后续规则和 UI 使用同一接口。
- Step 2: 规则引擎与修正流水线
  - [ ] 实现文本检测与自动修正流水线，支持一次执行返回“修正后文本 + 诊断列表 + 统计信息”。
  - [ ] 完成规则冲突处理策略（执行顺序、重复命中去重、位置回写）并用测试固定行为。
  - [ ] 为每条核心规则补齐单元测试，覆盖多行文本、空输入、URL/邮箱不误改等边界。
- Step 3: 双栏界面与高亮呈现
  - [ ] 实现左输入右输出布局，支持实时或手动触发纠错并稳定展示结果。
  - [ ] 接入高亮渲染与规则说明展示，保证每个高亮片段可追溯到规则信息。
  - [ ] 增加无问题状态、空输入状态与错误回退状态，确保界面行为可预期。
- Step 4: 质量门禁与交付
  - [ ] 增加关键流程的集成或 E2E 测试（输入示例 -> 输出文本 -> 高亮与统计一致）。
  - [ ] 验证长文本性能阈值并记录基线（例如 5k 字符在可接受时间内完成检测与渲染）。
  - [ ] 补充 README 中的运行与验证说明，确保新成员可一键启动与验收。

## Open Questions

- Question: 首版技术栈是否限定（React/Vue/Svelte，是否必须 TypeScript）？
  - Answer: 使用 React 和 TypeScript
- Question: 纠错触发方式是“实时输入即修正”还是“点击按钮后修正”，或两者都支持？
  - Answer: 两者都支持
- Question: URL、邮箱、Markdown 代码块等免修正范围的精确定义是什么？
  - Answer: 碰到 URL，邮箱，Markdown 代码块等直接忽略检查
- Question: 高亮交互是否需要支持鼠标悬浮说明、点击定位、或导出修正报告？
  - Answer: 需要支持鼠标悬浮说明，点击定位和点击修复，也可以直接使用一个按钮进行全局修复，不需要导出修正报告
- Question: 性能验收阈值具体是多少（文本长度、响应时间、目标设备）？
  - Answer: 文本长度可以将这篇文章的长度为阈值：<https://mp.weixin.qq.com/s?__biz=MzI2NzExNTczMw==&mid=2653293705&idx=1&sn=7cc3650946fd73453170b2a62d8630c3&chksm=f1516133c626e825db9315d49f75a5d2b100ec541269572c1f1b08d136bd293b8dcabfc3a02f&scene=178&cur_album_id=3602900017125556226&search_click_id=#rd>\
    响应时间不能超过 1 分钟\
    设备需要支持主流浏览器，包括手机端浏览器

## Implementation Summary

\[Auto-generated after completion: what changed + tests run.]
